# 包括的な勤怠管理システムのテーブル仕様

## 1. 部署テーブル (departments)

| カラム名        | データ型     | NULL | キー   | デフォルト        | 説明     |
| --------------- | ------------ | ---- | ------ | ----------------- | -------- |
| department_id   | INT          | NO   | PK, AI |                   | 部署 ID  |
| department_name | VARCHAR(100) | NO   |        |                   | 部署名   |
| created_at      | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時 |
| updated_at      | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時 |

## 2. 勤務地テーブル (work_locations)

| カラム名      | データ型     | NULL | キー   | デフォルト        | 説明      |
| ------------- | ------------ | ---- | ------ | ----------------- | --------- |
| location_id   | INT          | NO   | PK, AI |                   | 勤務地 ID |
| location_name | VARCHAR(100) | NO   |        |                   | 勤務地名  |
| address       | VARCHAR(255) | NO   |        |                   | 住所      |
| created_at    | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時  |
| updated_at    | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時  |

## 3. 従業員テーブル (employees)

| カラム名            | データ型     | NULL | キー   | デフォルト        | 説明                |
| ------------------- | ------------ | ---- | ------ | ----------------- | ------------------- |
| employee_id         | INT          | NO   | PK, AI |                   | 従業員 ID           |
| first_name          | VARCHAR(50)  | NO   |        |                   | 名                  |
| last_name           | VARCHAR(50)  | NO   |        |                   | 姓                  |
| email               | VARCHAR(100) | NO   | UQ     |                   | メールアドレス      |
| hire_date           | DATE         | NO   |        |                   | 入社日              |
| department_id       | INT          | NO   | FK     |                   | 部署 ID             |
| position            | VARCHAR(100) | NO   |        |                   | 役職                |
| default_location_id | INT          | NO   | FK     |                   | デフォルト勤務地 ID |
| created_at          | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時            |
| updated_at          | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時            |

外部キー制約:

- `department_id` は `departments(department_id)` を参照
- `default_location_id` は `work_locations(location_id)` を参照

## 4. 日次勤務記録テーブル (daily_work_records)

| カラム名       | データ型  | NULL | キー   | デフォルト        | 説明           |
| -------------- | --------- | ---- | ------ | ----------------- | -------------- |
| record_id      | INT       | NO   | PK, AI |                   | 記録 ID        |
| employee_id    | INT       | NO   | FK     |                   | 従業員 ID      |
| date           | DATE      | NO   |        |                   | 勤務日         |
| start_time     | TIME      | YES  |        |                   | 開始時間       |
| end_time       | TIME      | YES  |        |                   | 終了時間       |
| break_duration | INT       | NO   |        | 0                 | 休憩時間（分） |
| location_id    | INT       | NO   | FK     |                   | 勤務地 ID      |
| created_at     | TIMESTAMP | NO   |        | CURRENT_TIMESTAMP | 作成日時       |
| updated_at     | TIMESTAMP | NO   |        | CURRENT_TIMESTAMP | 更新日時       |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照
- `location_id` は `work_locations(location_id)` を参照

ユニークキー:

- `unique_employee_date` (employee_id, date)

## 5. 月次勤務記録テーブル (monthly_work_records)

| カラム名         | データ型     | NULL | キー   | デフォルト        | 説明         |
| ---------------- | ------------ | ---- | ------ | ----------------- | ------------ |
| record_id        | INT          | NO   | PK, AI |                   | 記録 ID      |
| employee_id      | INT          | NO   | FK     |                   | 従業員 ID    |
| year             | INT          | NO   |        |                   | 年           |
| month            | INT          | NO   |        |                   | 月           |
| total_work_hours | DECIMAL(7,2) | NO   |        | 0                 | 合計勤務時間 |
| overtime_hours   | DECIMAL(7,2) | NO   |        | 0                 | 残業時間     |
| created_at       | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時     |
| updated_at       | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時     |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照

ユニークキー:

- `unique_employee_month` (employee_id, year, month)

## 6. 従業員シフトテーブル (employee_shifts)

| カラム名    | データ型  | NULL | キー   | デフォルト        | 説明      |
| ----------- | --------- | ---- | ------ | ----------------- | --------- |
| shift_id    | INT       | NO   | PK, AI |                   | シフト ID |
| employee_id | INT       | NO   | FK     |                   | 従業員 ID |
| date        | DATE      | NO   |        |                   | 日付      |
| start_time  | TIME      | NO   |        |                   | 開始時間  |
| end_time    | TIME      | NO   |        |                   | 終了時間  |
| location_id | INT       | NO   | FK     |                   | 勤務地 ID |
| created_at  | TIMESTAMP | NO   |        | CURRENT_TIMESTAMP | 作成日時  |
| updated_at  | TIMESTAMP | NO   |        | CURRENT_TIMESTAMP | 更新日時  |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照
- `location_id` は `work_locations(location_id)` を参照

ユニークキー:

- `unique_employee_shift` (employee_id, date)

## 7. 勤怠異常記録テーブル (attendance_irregularities)

| カラム名        | データ型                               | NULL | キー   | デフォルト        | 説明        |
| --------------- | -------------------------------------- | ---- | ------ | ----------------- | ----------- |
| irregularity_id | INT                                    | NO   | PK, AI |                   | 異常記録 ID |
| employee_id     | INT                                    | NO   | FK     |                   | 従業員 ID   |
| date            | DATE                                   | NO   |        |                   | 日付        |
| type            | ENUM('遅刻', '早退', '欠勤', 'その他') | NO   |        |                   | 異常タイプ  |
| reason          | TEXT                                   | YES  |        |                   | 理由        |
| created_at      | TIMESTAMP                              | NO   |        | CURRENT_TIMESTAMP | 作成日時    |
| updated_at      | TIMESTAMP                              | NO   |        | CURRENT_TIMESTAMP | 更新日時    |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照

## 8. 会社休日テーブル (company_holidays)

| カラム名    | データ型     | NULL | キー   | デフォルト        | 説明     |
| ----------- | ------------ | ---- | ------ | ----------------- | -------- |
| holiday_id  | INT          | NO   | PK, AI |                   | 休日 ID  |
| date        | DATE         | NO   | UQ     |                   | 日付     |
| description | VARCHAR(200) | YES  |        |                   | 説明     |
| created_at  | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時 |
| updated_at  | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時 |

## 9. 従業員休暇残高テーブル (employee_leave_balances)

| カラム名           | データ型     | NULL | キー   | デフォルト        | 説明         |
| ------------------ | ------------ | ---- | ------ | ----------------- | ------------ |
| balance_id         | INT          | NO   | PK, AI |                   | 残高 ID      |
| employee_id        | INT          | NO   | FK     |                   | 従業員 ID    |
| year               | INT          | NO   |        |                   | 年           |
| paid_leave_balance | DECIMAL(5,1) | NO   |        | 0                 | 有給休暇残高 |
| comp_time_balance  | DECIMAL(5,1) | NO   |        | 0                 | 代休残高     |
| created_at         | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時     |
| updated_at         | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時     |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照

ユニークキー:

- `unique_employee_year` (employee_id, year)

## 10. 休暇申請テーブル (leave_requests)

| カラム名    | データ型                                       | NULL | キー   | デフォルト        | 説明       |
| ----------- | ---------------------------------------------- | ---- | ------ | ----------------- | ---------- |
| request_id  | INT                                            | NO   | PK, AI |                   | 申請 ID    |
| employee_id | INT                                            | NO   | FK     |                   | 従業員 ID  |
| start_date  | DATE                                           | NO   |        |                   | 開始日     |
| end_date    | DATE                                           | NO   |        |                   | 終了日     |
| leave_type  | ENUM('有給休暇', '代休', '特別休暇', 'その他') | NO   |        |                   | 休暇タイプ |
| reason      | TEXT                                           | YES  |        |                   | 理由       |
| status      | ENUM('申請中', '承認', '却下')                 | NO   |        | '申請中'          | 状態       |
| approver_id | INT                                            | YES  | FK     |                   | 承認者 ID  |
| created_at  | TIMESTAMP                                      | NO   |        | CURRENT_TIMESTAMP | 作成日時   |
| updated_at  | TIMESTAMP                                      | NO   |        | CURRENT_TIMESTAMP | 更新日時   |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照
- `approver_id` は `employees(employee_id)` を参照

## 11. 残業申請テーブル (overtime_requests)

| カラム名        | データ型                       | NULL | キー   | デフォルト        | 説明      |
| --------------- | ------------------------------ | ---- | ------ | ----------------- | --------- |
| request_id      | INT                            | NO   | PK, AI |                   | 申請 ID   |
| employee_id     | INT                            | NO   | FK     |                   | 従業員 ID |
| date            | DATE                           | NO   |        |                   | 日付      |
| requested_hours | DECIMAL(4,2)                   | NO   |        |                   | 申請時間  |
| reason          | TEXT                           | YES  |        |                   | 理由      |
| status          | ENUM('申請中', '承認', '却下') | NO   |        | '申請中'          | 状態      |
| approver_id     | INT                            | YES  | FK     |                   | 承認者 ID |
| created_at      | TIMESTAMP                      | NO   |        | CURRENT_TIMESTAMP | 作成日時  |
| updated_at      | TIMESTAMP                      | NO   |        | CURRENT_TIMESTAMP | 更新日時  |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照
- `approver_id` は `employees(employee_id)` を参照

## 12. プロジェクトテーブル (projects)

| カラム名     | データ型     | NULL | キー   | デフォルト        | 説明            |
| ------------ | ------------ | ---- | ------ | ----------------- | --------------- |
| project_id   | INT          | NO   | PK, AI |                   | プロジェクト ID |
| project_name | VARCHAR(100) | NO   |        |                   | プロジェクト名  |
| start_date   | DATE         | NO   |        |                   | 開始日          |
| end_date     | DATE         | YES  |        |                   | 終了日          |
| created_at   | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時        |
| updated_at   | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時        |

## 13. プロジェクト時間記録テーブル (project_time_logs)

| カラム名     | データ型     | NULL | キー   | デフォルト        | 説明            |
| ------------ | ------------ | ---- | ------ | ----------------- | --------------- |
| log_id       | INT          | NO   | PK, AI |                   | ログ ID         |
| employee_id  | INT          | NO   | FK     |                   | 従業員 ID       |
| project_id   | INT          | NO   | FK     |                   | プロジェクト ID |
| date         | DATE         | NO   |        |                   | 日付            |
| hours_worked | DECIMAL(5,2) | NO   |        |                   | 作業時間        |
| description  | TEXT         | YES  |        |                   | 作業内容        |
| created_at   | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時        |
| updated_at   | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時        |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照
- `project_id` は `projects(project_id)` を参照

## 14. スキルテーブル (skills)

| カラム名   | データ型     | NULL | キー   | デフォルト        | 説明      |
| ---------- | ------------ | ---- | ------ | ----------------- | --------- |
| skill_id   | INT          | NO   | PK, AI |                   | スキル ID |
| skill_name | VARCHAR(100) | NO   | UQ     |                   | スキル名  |
| created_at | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時  |
| updated_at | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時  |

## 15. 従業員スキルテーブル (employee_skills)

| カラム名          | データ型                                     | NULL | キー   | デフォルト        | 説明            |
| ----------------- | -------------------------------------------- | ---- | ------ | ----------------- | --------------- |
| employee_skill_id | INT                                          | NO   | PK, AI |                   | 従業員スキル ID |
| employee_id       | INT                                          | NO   | FK     |                   | 従業員 ID       |
| skill_id          | INT                                          | NO   | FK     |                   | スキル ID       |
| proficiency_level | ENUM('初級', '中級', '上級', 'エキスパート') | NO   |        |                   | 習熟度          |
| created_at        | TIMESTAMP                                    | NO   |        | CURRENT_TIMESTAMP | 作成日時        |
| updated_at        | TIMESTAMP                                    | NO   |        | CURRENT_TIMESTAMP | 更新日時        |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照
- `skill_id` は `skills(skill_id)` を参照

ユニークキー:

- `unique_employee_skill` (employee_id, skill_id)

## 16. 資格テーブル (certifications)

| カラム名           | データ型     | NULL | キー   | デフォルト        | 説明     |
| ------------------ | ------------ | ---- | ------ | ----------------- | -------- |
| certification_id   | INT          | NO   | PK, AI |                   | 資格 ID  |
| certification_name | VARCHAR(100) | NO   | UQ     |                   | 資格名   |
| created_at         | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時 |
| updated_at         | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時 |

## 17. 従業員資格テーブル (employee_certifications)

| カラム名                  | データ型  | NULL | キー   | デフォルト        | 説明          |
| ------------------------- | --------- | ---- | ------ | ----------------- | ------------- |
| employee_certification_id | INT       | NO   | PK, AI |                   | 従業員資格 ID |
| employee_id               | INT       | NO   | FK     |                   | 従業員 ID     |
| certification_id          | INT       | NO   | FK     |                   | 資格 ID       |
| acquisition_date          | DATE      | NO   |        |                   | 取得日        |
| expiration_date           | DATE      | YES  |        |                   | 有効期限      |
| created_at                | TIMESTAMP | NO   |        | CURRENT_TIMESTAMP | 作成日時      |
| updated_at                | TIMESTAMP | NO   |        | CURRENT_TIMESTAMP | 更新日時      |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照
- `certification_id` は `certifications(certification_id)` を参照

ユニークキー:

- `unique_employee_certification` (employee_id, certification_id)

## 18. 給与情報テーブル (salary_info)

| カラム名       | データ型      | NULL | キー   | デフォルト        | 説明        |
| -------------- | ------------- | ---- | ------ | ----------------- | ----------- |
| salary_info_id | INT           | NO   | PK, AI |                   | 給与情報 ID |
| employee_id    | INT           | NO   | FK, UQ |                   | 従業員 ID   |
| base_salary    | DECIMAL(10,2) | NO   |        |                   | 基本給      |
| hourly_rate    | DECIMAL(7,2)  | YES  |        |                   | 時給        |
| created_at     | TIMESTAMP     | NO   |        | CURRENT_TIMESTAMP | 作成日時    |
| updated_at     | TIMESTAMP     | NO   |        | CURRENT_TIMESTAMP | 更新日時    |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照

## 19. 勤務評価テーブル (performance_reviews)

| カラム名          | データ型  | NULL | キー   | デフォルト        | 説明       |
| ----------------- | --------- | ---- | ------ | ----------------- | ---------- |
| review_id         | INT       | NO   | PK, AI |                   | 評価 ID    |
| employee_id       | INT       | NO   | FK     |                   | 従業員 ID  |
| reviewer_id       | INT       | NO   | FK     |                   | 評価者 ID  |
| review_date       | DATE      | NO   |        |                   | 評価日     |
| performance_score | INT       | NO   |        |                   | 評価スコア |
| comments          | TEXT      | YES  |        |                   | コメント   |
| created_at        | TIMESTAMP | NO   |        | CURRENT_TIMESTAMP | 作成日時   |
| updated_at        | TIMESTAMP | NO   |        | CURRENT_TIMESTAMP | 更新日時   |

外部キー制約:

- `employee_id` は `employees(employee_id)` を参照
- `reviewer_id` は `employees(employee_id)` を参照

## 20. 勤怠ポリシーテーブル (attendance_policies)

| カラム名            | データ型     | NULL | キー   | デフォルト        | 説明         |
| ------------------- | ------------ | ---- | ------ | ----------------- | ------------ |
| policy_id           | INT          | NO   | PK, AI |                   | ポリシー ID  |
| department_id       | INT          | YES  | FK     |                   | 部署 ID      |
| standard_work_hours | DECIMAL(4,2) | NO   |        |                   | 標準勤務時間 |
| max_overtime_hours  | DECIMAL(4,2) | YES  |        |                   | 最大残業時間 |
| created_at          | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 作成日時     |
| updated_at          | TIMESTAMP    | NO   |        | CURRENT_TIMESTAMP | 更新日時     |

外部キー制約:

- `department_id` は `departments(department_id)` を参照

注意事項:

1. すべてのテーブルに `created_at` と `updated_at` カラムを追加し、レコードの作成日時と最終更新日時を追跡しています。
2. 外部キー制約を使用して、テーブル間の関連性を保証しています。
3. 適切な場所にユニークキーを設定し、データの一意性を確保しています。
4. ENUM 型を使用して、特定のカラムの値を制限しています。
5. 日付と時間に関連するカラムには、それぞれ DATE 型と TIME 型を使用しています。
6. 金額や時間に関連する数値には DECIMAL 型を使用し、適切な精度を設定しています。

この仕様書は、包括的な勤怠管理システムの基本的なデータベース構造を提供します。実際の実装時には、パフォーマンスの最適化やセキュリティの考慮など、追加の設定が必要になる場合があります。
